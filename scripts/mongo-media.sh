mongo dictio --eval 'db.media.aggregate([{"$lookup": {from: "entries", let: {mediaLocation: "$location"},pipeline: [{"$match": {"$expr": {"$or": [{"$eq": ["$lemma.video_front", "$$mediaLocation"]},{"$eq": ["$lemma.video_side", "$$mediaLocation"]},]}}},{"$project": {"id":1,"dict":1, "_id":0}}], as: "entryDocs"}},{"$lookup": {from: "entries", localField: "id",foreignField: "meanings.text.file.@media_id", as: "entryDocs2"}},{"$lookup": {from: "entries", localField: "id",foreignField: "meanings.usages.text.file.@media_id", as: "entryDocs3"}},{"$project": {id: 1, dict:1, location: 1, id_meta_copyright: 1, id_meta_author:1, id_meta_source: 1, status:1, type:1, "entryDocs":1, "entryDocs2.id": 1, "entryDocs2.dict": 1, "entryDocs3.id": 1, "entryDocs3.dict": 1}},{"$project": {id: 1, dict:1, location: 1, id_meta_copyright: 1, id_meta_author:1, id_meta_source: 1, status:1, type:1, "entryDocs":{"$setUnion":["$entryDocs","$entryDocs2", "$entryDocs3"]}}},{"$out": "mediaExport"}]);'
